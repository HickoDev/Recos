:root { --bg:#0f1115; --panel:#1c212b; --accent:#3d82f7; --danger:#e55353; --warn:#e0a800; --ok:#3bb273; --text:#e6e9ef; --muted:#8892a0; --critical:#e55353; --high:#ff9f43; --medium:#e0a800; --low:#3bb273; }
.light { --bg:#f5f7fb; --panel:#ffffff; --accent:#1d5ed9; --danger:#d81e34; --warn:#c78800; --ok:#148f55; --text:#1d2430; --muted:#627080; --critical:#d81e34; --high:#ff8c2f; --medium:#c78800; --low:#148f55; }
body { margin:0; font-family: system-ui, Arial, sans-serif; background: var(--bg); color: var(--text); transition: background .25s, color .25s; }
header { padding:12px 20px; background:#161a21; display:flex; justify-content:space-between; align-items:center; }
h1 { font-size:18px; margin:0; font-weight:600; letter-spacing:.5px; }
a { color: var(--accent); text-decoration:none; }
a:hover { text-decoration: underline; }
main { padding: 16px 24px 60px; }
.grid { display:grid; gap:16px; }
@media(min-width:1000px){ .grid.cols-3 { grid-template-columns:repeat(3,1fr);} }
.card { background:var(--panel); border:1px solid #262d38; border-radius:10px; padding:14px 16px 16px; box-shadow:0 2px 4px rgba(0,0,0,.4); position:relative; }
.card h2 { margin:0 0 12px; font-size:15px; letter-spacing:.4px; font-weight:600; }
small { color:var(--muted); }
table { width:100%; border-collapse: collapse; font-size:13px; }
th, td { padding:6px 8px; text-align:left; }
th { background:#222834; position:sticky; top:0; z-index:1; }
tbody tr:nth-child(even){ background:#20262f; }
tbody tr:hover { background:#2a3340; }
.badge { padding:2px 6px; border-radius: 12px; font-size:11px; font-weight:600; display:inline-block; }
.b-upgrade { background: var(--accent); color:#fff; }
.b-critical { background: var(--danger); color:#fff; }
.b-eol { background: #b347e5; color:#fff; }
.b-same { background: #3b5d82; color:#fff; }
.sev-chip { padding:2px 6px; border-radius:6px; font-size:10px; font-weight:600; display:inline-block; margin:0 2px 2px 0; }
.sev-critical { background:var(--critical); color:#fff; }
.sev-high { background:var(--high); color:#000; }
.sev-medium { background:var(--medium); color:#000; }
.sev-low { background:var(--low); color:#fff; }
.desig { cursor:pointer; transition: background-color .15s ease, color .15s ease, box-shadow .15s ease, transform .05s ease; }
.desig:hover { background: var(--accent); color:#fff; box-shadow: 0 0 0 2px rgba(61,130,247,0.18) inset; }
.desig:active { transform: translateY(1px); }
.desig:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
td.model-cell { cursor: pointer; }
td.model-cell:hover { color: var(--accent); text-decoration: underline; }
.flex { display:flex; align-items:center; gap:8px; }
.toolbar { display:flex; flex-wrap:wrap; gap:12px; margin:0 0 14px; }
select, button { background:#222834; color:var(--text); border:1px solid #2f3743; padding:6px 10px; border-radius:6px; font-size:13px; }
button { cursor:pointer; }
button:hover { background:#2a3340; }
.status-dot { width:8px; height:8px; border-radius:50%; display:inline-block; margin-right:4px; }
.dot-critical { background:var(--danger); }
.dot-ok { background:var(--ok); }
.mono { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px; }
/* Backdrop covering viewport; allow its own scroll but contain overscroll */
.modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; padding:40px 24px; overflow:auto; overscroll-behavior:contain; touch-action: pan-y; }
/* Elevate modal above sticky headers */
.modal-backdrop { z-index: 1000; }
.modal { position:relative; max-width:900px; width:100%; background:#1b2029; border:1px solid #2a313d; border-radius:12px; padding:20px 22px 26px; box-shadow:0 10px 40px rgba(0,0,0,.6); z-index:1010; height:85vh; display:grid; grid-template-rows: auto 1fr; overflow:hidden; }
.modal h3 { margin:0 0 10px; font-size:16px; }
/* Keep header from shrinking; body will take remaining space */
.modal > h3 { flex:0 0 auto; }
.close-btn { position:absolute; top:10px; right:14px; cursor:pointer; color:var(--muted); }
pre { background:#11161d; padding:14px 16px; border-radius:8px; overflow:auto; max-height:500px; font-size:12px; }
/* Allow long modal content (like CVE lists) to scroll within viewport */
#modal-body { min-height:0; overflow-y:auto; overscroll-behavior:contain; -webkit-overflow-scrolling: touch; touch-action: pan-y; scrollbar-gutter: stable; scrollbar-width: thin; scrollbar-color: var(--muted) transparent; }
#modal-body::-webkit-scrollbar { width:10px; }
#modal-body::-webkit-scrollbar-thumb { background:#3a4352; border-radius:8px; }
/* Affordance for clickable CVE list items */
.modal li[data-url] { cursor:pointer; }
.pill { background:#252d38; padding:4px 8px; border-radius:16px; font-size:11px; margin:2px; display:inline-block; }
.nowrap { white-space:nowrap; }
/* Sticky first column refined */
th.col-host { position:sticky; left:0; z-index:5; background:#222834; }
td.sticky-cell { position:sticky; left:0; background:var(--panel); z-index:4; box-shadow:2px 0 0 rgba(0,0,0,.25); }
.table-wrap { overflow:auto; max-height:60vh; overscroll-behavior:contain; }
th, td { white-space:nowrap; }
#devices-table { width:max-content; min-width:100%; }
.selected-row { outline:2px solid var(--accent); }
.controls-row { display:flex; flex-wrap:wrap; gap:8px; align-items:center; }
.hidden-col { display:none; }
.density-condensed table td, .density-condensed table th { padding:3px 5px; font-size:12px; }
.side-drawer { position:fixed; top:0; right:-480px; width:460px; height:100%; background:#1b2029; border-left:1px solid #2a313d; box-shadow:-4px 0 12px rgba(0,0,0,.4); transition:right .3s; z-index:1200; padding:18px 20px 60px; overflow:auto; }
.side-drawer.open { right:0; }
.drawer-close { position:absolute; top:8px; right:10px; cursor:pointer; }
canvas.inline-spark { width:60px; height:18px; }
.chart-area { display:flex; flex-wrap:wrap; gap:16px; margin-top:16px; }
.chart-card { flex:1 1 240px; min-width:240px; background:var(--panel); border:1px solid #262d38; border-radius:10px; padding:8px 10px 12px; }
.legend { font-size:11px; display:flex; flex-wrap:wrap; gap:8px; }
.legend span { display:flex; align-items:center; gap:4px; }
.legend i { width:12px; height:12px; display:inline-block; border-radius:3px; }
#columns-menu { z-index:600; }
#columns-menu { min-width:180px; }
#columns-menu label { display:flex; align-items:center; gap:6px; white-space:nowrap; line-height:1.2; }
#columns-menu input[type=checkbox] { margin:0; }

/* Prevent background page scroll when modal is open */
body.modal-open { overflow:hidden; }
.log-output { line-height:1.3; }
.log-warn { background:rgba(224,168,0,0.15); color:var(--warn); font-weight:600; }
#columns-menu { min-width:180px; }
#columns-menu label { display:flex; align-items:center; gap:6px; white-space:nowrap; line-height:1.2; }
#columns-menu input[type=checkbox] { margin:0; }
